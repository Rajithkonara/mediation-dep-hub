<?xml version="1.0" encoding="UTF-8"?>
<sequence
  name="com.wso2telco.dep.hub.paymentapi.customer.info.reader.Sequence"
  trace="disable" xmlns="http://ws.apache.org/ns/synapse">

  <property
    expression="get-property('registry', 'conf:/repository/wso2telco/configurations/PaymentAPI/customerInfoConfig.xml')"
    name="customerInfoConfig" scope="default" type="OM"/>
  <property
    expression="$ctx:customerInfoConfig//config[@operatorName=get-property('OPERATOR_NAME')]/tokenPoolEnabled"
    name="isTokenPoolEnabled" scope="default" type="STRING"/>
  <filter regex="true" source="get-property('isTokenPoolEnabled')">
    <then>
      <!-- TODO: need to implement when token-pool for customer-info call is ready -->
    </then>
    <else>
      <property
        expression="$ctx:customerInfoConfig//config[@operatorName=get-property('OPERATOR_NAME')]/accessToken"
        name="customerInfo.access.token" scope="default" type="STRING"/>
    </else>
  </filter>
  <property
          expression="$ctx:customerInfoConfig//config[@operatorName=get-property('OPERATOR_NAME')]/infoapi/apiEndpoint"
          name="uri.var.infoapiendpoint" scope="default" type="STRING" xmlns:ns="http://org.apache.synapse/xsd"/>
</sequence>
