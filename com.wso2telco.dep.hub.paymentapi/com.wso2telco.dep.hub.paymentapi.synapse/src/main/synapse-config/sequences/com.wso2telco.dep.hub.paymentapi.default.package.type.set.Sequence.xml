<?xml version="1.0" encoding="UTF-8"?>
<sequence
  name="com.wso2telco.dep.hub.paymentapi.default.package.type.set.Sequence"
  trace="disable" xmlns="http://ws.apache.org/ns/synapse">

  <!-- TODO : rename with a proper name -->
  <filter regex="Postpaid|Prepaid" source="$ctx:userpackagetype">
    <then>
      <property expression="get-property('CONSUMER_KEY')"
                name="consumerKey" scope="default" type="STRING" xmlns:ns="http://org.apache.synapse/xsd"/>
      <!-- check daily and monthly usage limits of payment API -->
      <class name="com.wso2telco.dep.common.mediation.spendlimit.mediator.CheckLimitMediator"/>
      <filter regex="true" source="get-property('INTERNAL_ERROR')">
        <then>
          <sequence key="com.wso2telco.dep.common.response.exceptions.Sequence"/>
        </then>
        <else/>
      </filter>
    </then>
    <else/>
  </filter>
</sequence>

